if(window.FileReader&&window.Promise&&"formNoValidate"in document.createElement("input")){var µ=document,checkValid=function(){var a;switch(this.setCustomValidity(""),this.name){case"b":a=this.isVisible()&&this.value.length<4;break;case"c":a=this.value.length<4||this.value.length>12;break;case"d":a=this.isVisible()&&this.value!==µ.one("[name=c]").value}a&&this.setCustomValidity(this.getAttribute("data-m"))},getLabel=function(a){µ.alls("[type=button]").forEach(function(){this.value=this.getAttribute(a?"data-k":"data-j")})},googleApi=function(){gapi.load("auth2",function(){auth2=gapi.auth2.init({client_id:"216469168993-dqhiqllodmfovgtrmjdf2ps5kj0h1gg9.apps.googleusercontent.com",scope:"email https://www.googleapis.com/auth/books",fetch_basic_profile:!1,prompt:"consent"}),µ.one("#f").setEvents("click",function(){auth2.grantOfflineAccess({redirect_uri:"postmessage"}).then(function(a){return a.code?(µ.one("div").toggle(!0),void sendRequest("/googleAuth",{c:a.code},function(a){return a&&a.success?window.location.reload(!0):(µ.one("div").toggle(!1),!1)})):!1})})})},razError=function(){µ.one(".forget").toggle(!1),µ.alls("[type=email], [type=password], [type=text]").toggleClass("e",!1),µ.one(".g").html(""),µ.one(".n").html("")},sendRequest=function(a,b,c){var d=new XMLHttpRequest;d.open("POST",a,!0),d.setRequestHeader("Content-Type","application/json"),d.onreadystatechange=function(){return 4===d.readyState&&200===d.status?(c(JSON.parse(d.responseText)),!1):void 0},d.send(JSON.stringify(b))};!function(){var a=µ.createElement("script");a.type="text/javascript",a.async=!0,a.src="https://apis.google.com/js/client:platform.js?onload=googleApi";var b=µ.one("script");b.parentNode.insertBefore(a,b)}(),µ.addEventListener("DOMContentLoaded",function(a){"use strict";µ.one("section").toggle(!0),µ.one("div").toggle(!1),µ.alls("input").setEvents("input propertychange",checkValid),µ.one("form").setEvents("submit",function(a){return a.preventDefault(),razError(),µ.one("div").toggle(!0),sendRequest(µ.one("[data-h]").isVisible()?"/new":"/login",this.formToJson(),function(a){return a&&a.success?window.location.reload(!0):(µ.alls("[type=email], [type=password], [type=text]").toggleClass("e",!0),µ.one("div").toggle(!1),µ.one("[type=email]").focus(),µ.one(".g").html(a.error),µ.one(".forget").toggle(!0),!1)}),!1}),µ.alls("[type=email],[type=password]").setEvents("change",razError),µ.alls("[type=button]").setEvents("click",function(){razError();var a=!µ.one("[data-h]").isVisible();getLabel(a),µ.alls("[data-h]").setValue(""),a?µ.alls("[data-h]").setAttributes({required:!0}):µ.alls("[data-h]").removeAttributes("required"),µ.alls("[data-h]").fade(),µ.one("[type=email]").focus()}),µ.one("button.m").setEvents("click",function(){razError(),µ.one("div").toggle(!0),sendRequest("/mail",µ.one("form").formToJson(),function(a){return a.error&&(µ.one(".forget").toggle(!0),µ.alls("[type=email], [type=password], [type=text]").toggleClass("e",!0)),µ.one(".g").html(a.error||""),µ.one(".n").html(a.success||""),µ.one("div").toggle(!1),!1})})})}else document.one("div").toggleClass("notdisplayed"),alert("Votre navigateur n'est pas compatible!!!");
