var start=new Date,µ=document,app=angular.module("admin",["preloader","socket","defcloak"]);app.config(["$interpolateProvider","$sceProvider",function(a,b,c){a.startSymbol("[{"),a.endSymbol("}]"),b.enabled(!1)}]),app.run(["$rootScope","$http","$window","$timeout","$socket","$preloader","$window",function(a,b,c,d,e,f,c){a.show={},a.logout=function(){return location.assign("/logout"),e.close(),!1},a.orders={},e.on("users",function(b){a.users=b}),e.on("sessions",function(b){a.sessions=b}),e.on("books",function(b,c){a.books=b,a.persos=c}),e.on("covers",function(b){a.covers=b,_.forEach(b,function(a){f.preloadImages(a.cover).then(function(){a.source={"background-image":"url("+a.cover+")"}})})}),e.on("comments",function(b){a.comments=b}),e.on("notifications",function(b){a.notifications=b}),angular.element(µ.alls("h2")).bind("click",function(){a.$apply(a.show[this.parentNode.getAttribute("type")]=!a.show[this.parentNode.getAttribute("type")])}),angular.element(µ.one("#logout")).bind("click",function(){a.logout()}),angular.element(µ.one("#footer")).bind("click",function(){var a=setInterval(function(){var b=((c.scrollY||µ.documentElement.scrollTop)/2-.1).toFixed(1);c.scroll(0,b),.1>=b&&(c.scroll(0,0),clearInterval(a))},100)}),angular.element(µ.alls("[field]")).bind("click",function(){var b=this.parentNode.parentNode.getAttribute("type"),c=this.getAttribute("field");a.orders[c]=!a.orders[c],a[b]=_.sortBy(a[b],c),a.orders[c]&&a[b].reverse(),a.$apply()}),angular.element(c).bind("scroll",function(){a.$apply(a.footer=c.scrollY||µ.documentElement.scrollTop)})}]),app.directive("submit",["$socket",function(a){return{restrict:"A",link:{post:function(b,c,d){c.on("click",function(){var c=_.find(_.keys(b),function(a){return!_.startsWith(a,"$")});a.emit("update",{collection:c+"s",values:b[c]})})}}}}]),app.directive("delete",["$socket",function(a){return{restrict:"A",link:function(b,c,d){c.on("click",function(){var c=_.find(_.keys(b),function(a){return!_.startsWith(a,"$")});a.emit("delete",{collection:c+"s",_id:b[c]._id}),b.$apply(_.remove(b.$parent[c+"s"],b[c]))})}}}]);
