"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};(function(){var a="object"===("undefined"==typeof global?"undefined":_typeof(global))&&global&&global.Object===Object&&global,b="object"===("undefined"==typeof self?"undefined":_typeof(self))&&self&&self.Object===Object&&self,c=a||b||Function("return this")(),d=function e(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!(this instanceof e))return new e(a,b,c);this.method=_.toUpper(b),this.headers={};for(var d in c)_.has(c,d)&&(this.headers[_.toUpper(d)]=c[d]);return this.url=_.startsWith(a,"http")||_.startsWith(a,"/")?a:"/"+a,this.req=new XMLHttpRequest,this};d.prototype.jsonToQueryString=function(a){var b="",c=_.keys(a),d=c.length-1;return _.isPlainObject(a)&&(b+="?",_.forEach(c,function(c,e){b+=c+"="+a[c],d>e&&(b+="&")})),this.url+=encodeURI(b),this},d.prototype["long"]=function(a){return this.req.timeout=9e5,this.send(a)},d.prototype.send=function(a){var b=this;return this.url?new Promise(function(c,d){var e=function(a){b.error={state:b.req.readyState,status:b.req.status,error:b.req.responseText,type:a.type},_.includes([401,403],b.req.status)?em.emit("logout"):d(b.error)},f=function(){b.response=b.req.responseText;try{b.response=JSON.parse(b.req.response)}catch(a){}c(b.response)};try{"GET"===b.method?b.jsonToQueryString(a):!_.has(b.headers,"CONTENT-TYPE")&&_.isPlainObject(a)?(b.headers={"CONTENT-TYPE":"application/json;charset=UTF-8"},b.data=JSON.stringify(a)):b.data=a,b.req.open(b.method,b.url,!0),b.setHeaders(),b.req.addEventListener("error",e),b.req.addEventListener("abort",e),b.req.addEventListener("timeout",e),b.req.addEventListener("load",f),b.req.send(b.data)}catch(g){d(g)}}):Promise.reject(new Error(["Request invalid argument","URL parameter is missing."]))},d.prototype.setHeaders=function(){for(var a in this.headers)_.has(this.headers,a)&&this.req.setRequestHeader(a,this.headers[a]);return this},c.req=d}).call(void 0);